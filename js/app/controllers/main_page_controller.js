// Generated by CoffeeScript 1.10.0
(function() {
  var app;

  app = angular.module('myApp');

  app.controller('mainCtrl', [
    '$scope', '$routeParams', 'UserDataService', 'getUser', 'getPosts', 'sendRating', 'getHighRate', function($scope, $routeParams, UserDataService, getUser, getPosts, sendRating, getHighRate) {
      $scope.destinations = {
        'user': getPosts(UserDataService.user),
        'all': getHighRate
      };
      getUser.success(function(data) {
        return UserDataService.user = data;
      });
      $scope.posts = [];
      $scope.action = function() {
        $scope.destinations[$routeParams.destination].get().then(function(posts) {
          console.log(posts.data);
          $scope.posts = posts.data;
        }, function(err) {
          console.log(err.data);
        });
      };
      $scope.action();
      $scope.changeRating = function(post, inc) {
        var rating;
        rating = {
          id: post.id,
          score: inc
        };
        console.log(rating);
        sendRating(rating).success(function(res) {
          console.log(res);
          post.score = res.score;
        }).error(function() {
          return console.log("already rated");
        });
      };
    }
  ]);

}).call(this);

//# sourceMappingURL=main_page_controller.js.map
